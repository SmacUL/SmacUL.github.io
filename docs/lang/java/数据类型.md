# 数据管理

这一部分简单的讨论一下 Java 的数据类型和数据存储的问题. 

## 数据类型

Java 中的数据类型和 JS 中的比较相似, 包括了**基本类型**和**对象类型**. 可能会好奇, Java 不是纯面向对象的语言吗? 那保留基本类型是不是违背了这个准则? 我觉得是这样, 但是从性能方面考虑, 将一个简单的数字或字符封装成一个对象, 实在不像个好主意. 

### 基本类型
Java 的基本类型一共八种, 表中的 `void` 是当变量没有被赋值时的值. 基本类型不会创建对象，而是创建一个并非是引用的「自动」变量，直接存储「值」; 

得益于 JVM 的底层支持, Java 的基本类型并不会像 C 那样, 在不同的设备上有不同的大小; 

| 基本类型 | 默认值          | 大小   | 最小值    | 最大值           | 包装器类型 |
| -------- | --------------- | ------ | --------- | ---------------- | ---------- |
| boolean  | false           | -      | -         | -                | Boolean    |
| char     | '\u0000' (null) | 16 bit | Unicode 0 | Unicode 2^16 - 1 | Character  |
| byte     | (byte) 0        | 8 bit  | -128      | 127              | Byte       |
| short    | (short) 0       | 16 bit | -12^15    | 2^15 - 1         | Short      |
| int      | 0               | 32 bit | -2^31     | 2^31 - 1         | Integer    |
| long     | 0L              | 64 bit | -2^63     | 2^63 - 1         | Long       |
| float    | 0.0f            | 32 bit | IEEE754   | IEEE754          | Float      |
| double   | 0.0d            | 64 bit | IEEE754   | IEEE754          | Double     |
| void     | -               | -      | -         | -                | -          |


### 对象类型

Java 要求使用引用操纵对象.

#### 数组也是对象

如果说 `String[] a` 看起来还倒像即将引用一个对象, 那么 `int[] a` 就给人感觉距离对象有些遥远了. 但是不管是哪种形式的数组, 本质上都是对象. 

数组的创建是在运行时进行的, 所有的数组都会包含一个固定成员，即 length , 标明数组的长度.

**初始化数组的有两种方式**
``` Java
int[] a = {1, 2};
int[] a = new int[length];
```
第二种初始化数组的方式看起来要好得多, 长得更像是创建一个数组对象. 

Java 的数据类型分为基本类型和对象类型, 那么数组里面就可能有存在基本类型和对象引用. 如果数组元素在创建时没有被赋值, 前者将被自动赋为相应基本类型的默认值, 后者将被赋值为 `null` .

## 数据装(拆)箱与转型

### 装(拆)箱

基本类型如何与对象相互转换? JVM 支持自动打(拆)包, 在必要的时候, 将基本类型转成相应的包装器类型, 同时, 也允许将包装器类型转为基本类型. 

### 转型

转型包括向上转型与向下转型. 在笔记一开始讨论过, 为了减小耦合, 应该尽可能地操纵基类的引用, 想办法将对象向更加抽象(向上)的方向转变; 但是, 向上转型意味着屏蔽了子类对象的一些属性或者方法, 那么在必要的时候, 还需要强制类型转换来向下转型, 保证正常的功能. 

一般来说, 将一个对象向上转型成其基类的对象是一件比较安全的事情, Java 的继承机制允许子类对象直接代替基类对象; 但是将一个标明了是基类的对象向下转型为子类的对象, 是比较危险的, 毕竟不能无中生有. 

## 数据存储
存储数据的 5 个位置
- 寄存器   
    高速存储器
- 堆栈  
    位于内存，「引用」数据和「基本类型」在其中，Java 对象不在其中；
    Java 系统需要知道堆栈内所有顶的确切生命周期；
- 堆  
    位于内存，一个通用内存池，存储所有 Java 对象
    相比堆栈内的数据管理，堆内的数据管理要灵活的多
- 常量存储  
    代码内部
- 非内存存储
    - 流对象（网路中）
    - 持久化对象（数据库中）

::: tip
数据存储中两个非常重要的位置, 堆栈 (存储对象引用和基本类型) 和堆 (存储对象).
:::

