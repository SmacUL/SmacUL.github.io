(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{285:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ajax-与-conet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-与-conet"}},[t._v("#")]),t._v(" Ajax 与 Conet")]),t._v(" "),a("h2",{attrs:{id:"xmlhttprequest-对象-xhr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest-对象-xhr"}},[t._v("#")]),t._v(" XMLHttpRequest 对象 (XHR)")]),t._v(" "),a("p",[t._v("各个浏览器都支持原生的 XHR 对象;")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xhr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"xhr-的基本用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xhr-的基本用法"}},[t._v("#")]),t._v(" XHR 的基本用法")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("xhr.open(请求类型, 请求的 URL , 是否异步)")]),t._v(";"),a("br"),t._v("\nURL 相遇对执行代码的当前路径;"),a("br"),t._v("\nopen 方法只是准备, 并不会发送请求;"),a("br"),t._v("\n是否异步的参数: true 为异步, false 为同步")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("xhr.send(作为请求主体发送的数据)")]),t._v(";"),a("br"),t._v("\nsend 方法发送请求;")])])]),t._v(" "),a("h3",{attrs:{id:"xhr-的返回数据处理-同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xhr-的返回数据处理-同步"}},[t._v("#")]),t._v(" XHR 的返回数据处理(同步)")]),t._v(" "),a("p",[t._v("接受服务器响应数据:")]),t._v(" "),a("p",[t._v("服务器的响应数据会被自动填充到 xhr 的属性中;")]),t._v(" "),a("p",[t._v("响应数据一般有:")]),t._v(" "),a("ul",[a("li",[t._v("status")]),t._v(" "),a("li",[t._v("statusText")]),t._v(" "),a("li",[t._v("responseText")]),t._v(" "),a("li",[t._v("responseXML")])]),t._v(" "),a("p",[t._v("响应内容为 text/xml 或者 application/xml")]),t._v(" "),a("p",[t._v("这个属性中将保存包含着响应数据的 XML DOM 文档;")]),t._v(" "),a("p",[t._v("对响应数据的处理:")]),t._v(" "),a("ol",[a("li",[t._v("检查 status 属性, HTTP 的代码;")])]),t._v(" "),a("p",[a("code",[t._v("xhr.staus >= 200 && xhr.status < 300 || xhr.status = 304")])]),t._v(" "),a("ol",[a("li",[t._v("访问 XHR 的 "),a("code",[t._v("responseText")]),t._v(" 或 "),a("code",[t._v("responseXML")])])]),t._v(" "),a("p",[a("code",[t._v("xhr.responseText / xhr.reponseXML")])]),t._v(" "),a("h3",{attrs:{id:"xhr-的返回数据处理-异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xhr-的返回数据处理-异步"}},[t._v("#")]),t._v(" XHR 的返回数据处理(异步)")]),t._v(" "),a("p",[t._v("XHR 的 readyState 属性标明了 请求-响应 过程的各个活动阶段;")]),t._v(" "),a("ul",[a("li",[t._v("0 未初始化"),a("br"),t._v("\n没有调用 open 方法")]),t._v(" "),a("li",[t._v("1 启动"),a("br"),t._v("\n调用了 open 方法, 没有调用 send 方法")]),t._v(" "),a("li",[t._v("2 发送"),a("br"),t._v("\n调用了open 和 send 方法")]),t._v(" "),a("li",[t._v("3 接收"),a("br"),t._v("\n响应数据接收过程")]),t._v(" "),a("li",[t._v("4 完成"),a("br"),t._v("\n响应数据接收完毕, 可以在客户端使用")])]),t._v(" "),a("p",[t._v("只要 "),a("code",[t._v("readyState")]),t._v(" 属性的值变化时, 就会触发 "),a("code",[t._v("readystatechange")]),t._v(" 事件;")]),t._v(" "),a("p",[t._v("在调用 "),a("code",[t._v("open()")]),t._v(" 方法之前, 需要设置 "),a("code",[t._v("readystatechange")]),t._v(" 的监听器;")]),t._v(" "),a("p",[t._v("在访问响应数据前, 检查 "),a("code",[t._v("readyState")]),t._v(" 的属性是否为 4 ;")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xhr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createXHR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("304")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Request was unsuccessful: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("h3",{attrs:{id:"http-头部信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-头部信息"}},[t._v("#")]),t._v(" HTTP 头部信息")]),t._v(" "),a("h3",{attrs:{id:"get-请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-请求"}},[t._v("#")]),t._v(" GET 请求")]),t._v(" "),a("h3",{attrs:{id:"post-请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#post-请求"}},[t._v("#")]),t._v(" POST 请求")]),t._v(" "),a("p",[t._v("post 请求会将数据作为请求的主体提交, 这是与 get 请求的一大区别;")]),t._v(" "),a("p",[t._v("可以将需要发送给服务器的数据封装之后 交给 send 方法")]),t._v(" "),a("h2",{attrs:{id:"xmlhttprequest-对象-2-级-xhr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest-对象-2-级-xhr"}},[t._v("#")]),t._v(" XMLHttpRequest 对象 (2 级 XHR)")]),t._v(" "),a("h3",{attrs:{id:"formdata-传输数据格式规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#formdata-传输数据格式规范"}},[t._v("#")]),t._v(" FormData 传输数据格式规范")]),t._v(" "),a("p",[t._v("FormData 用于序列化表单以及创建与表单格式相同的数据;")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" form "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user-info"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FormData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("form"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h3",{attrs:{id:"timeout-超时设定-仅仅-ie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timeout-超时设定-仅仅-ie"}},[t._v("#")]),t._v(" timeout 超时设定 (仅仅 IE)")]),t._v(" "),a("p",[t._v("timeout 单位是毫秒;")]),t._v(" "),a("p",[t._v("xhr 可以在超时之后触发 timeout 事件,")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ontimeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"timeout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"overridemimetype-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overridemimetype-方法"}},[t._v("#")]),t._v(" overrideMimeType 方法")]),t._v(" "),a("p",[t._v("MIME 多用途互联网邮件扩展类型;")]),t._v(" "),a("h2",{attrs:{id:"进度事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进度事件"}},[t._v("#")]),t._v(" 进度事件")]),t._v(" "),a("h3",{attrs:{id:"load-事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#load-事件"}},[t._v("#")]),t._v(" load 事件")]),t._v(" "),a("p",[t._v("一开始 firefox 使用了 load 事件, 在响应数据接收完毕后触发;")]),t._v(" "),a("p",[t._v("但是由于历史原因, 只要浏览器接到服务器的响应, 不论状态如何, 都会触发 load 事件;")]),t._v(" "),a("h3",{attrs:{id:"progress-事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#progress-事件"}},[t._v("#")]),t._v(" progress 事件")]),t._v(" "),a("h2",{attrs:{id:"跨源资源共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨源资源共享"}},[t._v("#")]),t._v(" 跨源资源共享")]),t._v(" "),a("p",[t._v("跨域的一般用于两个方面:")]),t._v(" "),a("ul",[a("li",[t._v("访问远程资源, 而非本地内容;")]),t._v(" "),a("li",[t._v("前后端分离的项目, 服务器的域不一致;")])]),t._v(" "),a("h3",{attrs:{id:"ie-对-cors-的实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ie-对-cors-的实现"}},[t._v("#")]),t._v(" IE 对 CORS 的实现")]),t._v(" "),a("p",[t._v("CORS: Cross-Origin Resouce Sharing 跨源资源共享,")]),t._v(" "),a("p",[t._v("定义了在访问跨原资源时, 浏览器与服务器应该如果沟通;")]),t._v(" "),a("p",[t._v("核心思想:")]),t._v(" "),a("p",[t._v("使用自定义的 HTTP 头部, 让浏览器与服务器进行沟通,")]),t._v(" "),a("p",[t._v("从而决定请求或响应是否应该成功;")]),t._v(" "),a("p",[t._v("有一个重要的东西: Access-Control-Allow-Origin ?")]),t._v(" "),a("p",[t._v("IE 引入了 XDR (XHR 的跨域版本) ;")]),t._v(" "),a("p",[t._v("XDR 的使用方法和 XHR 类似, 需要先使用 open 方法, 然后使用 send 方法;")]),t._v(" "),a("p",[t._v("使用 XDR 需要注意的地方:")]),t._v(" "),a("ul",[a("li",[t._v("XDR 默认是异步通信;")]),t._v(" "),a("li",[t._v("XDR 返回的数据只有原始本文, 没有状态代码;")]),t._v(" "),a("li",[t._v("只要访问有效, 就会触发 load 事件;")]),t._v(" "),a("li",[t._v("如果失败, 就会触发 error 事件,     没有报错信息;")]),t._v(" "),a("li",[t._v("load 和 error"),a("br"),t._v("\n事件的处理程序都要自己写, load 是必须的, error 可以不用;")])]),t._v(" "),a("h3",{attrs:{id:"其他浏览器对-cors-的实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他浏览器对-cors-的实现"}},[t._v("#")]),t._v(" 其他浏览器对 CORS 的实现")]),t._v(" "),a("p",[t._v("相比 IE , 其他浏览器就聪明的多, 使用标准的 XHR ,")]),t._v(" "),a("p",[t._v("并在 open 方法传入绝对 URL 即可;")]),t._v(" "),a("p",[t._v("这样的 XHR 可以访问 status 和 statusText 属性, 支持同步请求;")]),t._v(" "),a("p",[t._v("跨域 XHR 对象的限制:")]),t._v(" "),a("ul",[a("li",[t._v("不能使用 "),a("code",[t._v("setRequestHeader()")]),t._v("     设定自定义头部")]),t._v(" "),a("li",[t._v("不能发送和接受 cookie")]),t._v(" "),a("li",[t._v("调用     "),a("code",[t._v("getAllResponseHeaders()")]),t._v(" 方法总会返回空字符串;")])]),t._v(" "),a("p",[t._v("建议本地资源使用相对路径, 远程资源使用绝对路径;")]),t._v(" "),a("h3",{attrs:{id:"prefligted-requests"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prefligted-requests"}},[t._v("#")]),t._v(" Prefligted Requests")]),t._v(" "),a("p",[t._v("Prefligted Requests 是 CORS 的高阶使用方法,")]),t._v(" "),a("p",[t._v("允许用户:")]),t._v(" "),a("ul",[a("li",[t._v("使用自定义的头部;")]),t._v(" "),a("li",[t._v("GET 或 POST 以外的方法;")]),t._v(" "),a("li",[t._v("发送不同类型的主体内容;")])]),t._v(" "),a("h3",{attrs:{id:"带凭据的请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#带凭据的请求"}},[t._v("#")]),t._v(" 带凭据的请求")]),t._v(" "),a("p",[t._v("凭据: cookie / HTTP 认证 / 客户端 SSL 证明")]),t._v(" "),a("h3",{attrs:{id:"跨浏览器的-cors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨浏览器的-cors"}},[t._v("#")]),t._v(" 跨浏览器的 CORS")]),t._v(" "),a("h2",{attrs:{id:"其他跨域技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他跨域技术"}},[t._v("#")]),t._v(" 其他跨域技术")]),t._v(" "),a("h3",{attrs:{id:"图像-ping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图像-ping"}},[t._v("#")]),t._v(" 图像 Ping")]),t._v(" "),a("h3",{attrs:{id:"jsonp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp"}},[t._v("#")]),t._v(" JSONP")]),t._v(" "),a("p",[t._v("JSON with padding ,")]),t._v(" "),a("p",[t._v("script 标签不受域的限制, 可以随意访问;")]),t._v(" "),a("p",[t._v("分成两个部分, 回调函数和响应数据; 回调函数在本地, 响应数据在远程;")]),t._v(" "),a("p",[t._v("客户端通过 script 的 src 属性传入访问的 URL 以及本地的回调函数名,")]),t._v(" "),a("p",[t._v("服务器收到之后, 会将 response 加载到客户端的回调函数中;")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"You’re at IP address "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ip "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", which is in "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" \n    response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("city "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("region_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" script "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://freegeoip.net/json/?callback=handleResponse"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \ndocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("firstChild"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h3",{attrs:{id:"comet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#comet"}},[t._v("#")]),t._v(" Comet")]),t._v(" "),a("p",[t._v("Ajax 是一种 从客户端访问服务器的技术,")]),t._v(" "),a("p",[t._v("Comet 是一种 服务器向页面推送数据的技术;")]),t._v(" "),a("p",[t._v("Comet 的实现方式: 长轮询 和 流")]),t._v(" "),a("ul",[a("li",[t._v("短轮询")])]),t._v(" "),a("p",[t._v("浏览器时不时地向服务器发起请求, 查询是否有新的数据;")]),t._v(" "),a("ul",[a("li",[t._v("长轮询")])]),t._v(" "),a("p",[t._v("浏览器向服务器发起请求, 查询是否有新的数据,")]),t._v(" "),a("p",[t._v("如果有新的数据, 服务端才向浏览器发送响应, 完毕后连接关闭,")]),t._v(" "),a("p",[t._v("浏览器再重新向服务器发起请求;")]),t._v(" "),a("ul",[a("li",[t._v("HTTP 流")])]),t._v(" "),a("p",[t._v("不同于轮询, 流在页面的整个生命周期内只使用一个 HTTP 连接;")]),t._v(" "),a("p",[t._v("浏览器一开始就会向服务器发送一个请求, 而服务器保持连接,")]),t._v(" "),a("p",[t._v("同时服务器周期性地向浏览器发送数据;")]),t._v(" "),a("p",[t._v("XHR readstatechange 事件 readyState 是否为 3 (客户端开始接受数据)")]),t._v(" "),a("p",[t._v("readyState 为 4 时, 打包所有数据;")]),t._v(" "),a("div",{staticClass:"language-JS line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStreamingClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" progress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" finished")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xhr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" received "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\txhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\txhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//只取得最新数据并调整计数器")]),t._v("\n\t\t\tresult "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("received"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\treceived "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//调用 progress 回调函数")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("progress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("finished")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\txhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStreamingClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"streaming.php"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Received: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("h3",{attrs:{id:"服务器发送事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器发送事件"}},[t._v("#")]),t._v(" 服务器发送事件")]),t._v(" "),a("h3",{attrs:{id:"web-sockets"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-sockets"}},[t._v("#")]),t._v(" Web Sockets")]),t._v(" "),a("h3",{attrs:{id:"sse-和-websockets"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sse-和-websockets"}},[t._v("#")]),t._v(" SSE 和 WebSockets")])])}),[],!1,null,null,null);s.default=e.exports}}]);