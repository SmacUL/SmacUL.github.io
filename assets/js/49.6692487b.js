(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{234:function(s,t,e){"use strict";e.r(t);var a=e(0),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"遇到的-centos-的网络问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#遇到的-centos-的网络问题"}},[s._v("#")]),s._v(" 遇到的 CentOS 的网络问题")]),s._v(" "),e("h2",{attrs:{id:"启动时激活网卡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动时激活网卡"}},[s._v("#")]),s._v(" 启动时激活网卡")]),s._v(" "),e("p",[s._v("最小化安装, 忘记配置网络, 进入系统后发现没连上网络, 使用 "),e("code",[s._v("ip addr")]),s._v(" 无法获取网卡的 ip (只能获取一个 127 的本地地址),\n使用指令 "),e("code",[s._v("sudo nmtui")]),s._v(" 可以激活网卡 (利用 TAB 和 ENTER 键切换选项). 但是这种操作每次开机都要做一遍. 可以设置网卡自激活:")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也有可能不是 ifcfg-ens33 文件, 看情况")]),s._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysconfig/network-scripts/ifcfg-ens33\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 ens33 配置文件最后一行如下:")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存退出")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"无法重启-network-服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#无法重启-network-服务"}},[s._v("#")]),s._v(" 无法重启 network 服务")]),s._v(" "),e("p",[s._v("修改或配置网络后, 无法重启 network.service. "),e("code",[s._v("systemctl status network.service")]),s._v(" 提示 "),e("code",[s._v("Failed to start LSB: Bring up/down networking.")]),s._v(". 有可能是 NetworkManager 服务有冲突, 也有可能是 "),e("code",[s._v("/etc/sysconfig/network-script")]),s._v(" 下的配置文件有问题 (如果有改过的话). 前者 "),e("code",[s._v("systemctl restart NetworkManager")]),s._v(", 后者修改文件.")]),s._v(" "),e("h2",{attrs:{id:"防火墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#防火墙"}},[s._v("#")]),s._v(" 防火墙")]),s._v(" "),e("p",[s._v("感觉有玄学问题, 关一波防火墙 (手动狗头)")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl stop firewalld\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl disable firewalld\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"centos6-桥接模式的虚拟机转移后的网络问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#centos6-桥接模式的虚拟机转移后的网络问题"}},[s._v("#")]),s._v(" CentOS6 桥接模式的虚拟机转移后的网络问题")]),s._v(" "),e("p",[s._v("将 CentOS6 桥接模式, 且固定了 IP 的虚拟机转移到通网段下的另一台宿主机之后, eth* 网卡会出点问题, network.service 也无法重启. 访问一下 "),e("code",[s._v("/etc/sysconfig/network-script/ifcfg-eth0")]),s._v(", 可以发现转移虚拟机之后, 虽然 "),e("code",[s._v("ip addr")]),s._v(" 显示的网卡名称作了修改, 但是 "),e("code",[s._v("ifcfg-eth0")]),s._v(" 中的网卡配置信息没有跟着改过来, 需要手动修改设备名称与 Mac 地址 (都以 "),e("code",[s._v("ip addr")]),s._v(" 的显示结果为准), 最后重启 network.service .")]),s._v(" "),e("h2",{attrs:{id:"固定-ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#固定-ip"}},[s._v("#")]),s._v(" 固定 IP")]),s._v(" "),e("h3",{attrs:{id:"桥接模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#桥接模式"}},[s._v("#")]),s._v(" 桥接模式")]),s._v(" "),e("p",[s._v("还是我们的老朋友 "),e("code",[s._v("/etc/sysconfig/network-scripts/")]),s._v(" 下的 "),e("code",[s._v("ifcfg-ens*")]),s._v(" 或是 "),e("code",[s._v("ifcfg-eth*")]),s._v(".")]),s._v(" "),e("ol",[e("li",[s._v("将 "),e("code",[s._v('DEFROUTE="yes"')]),s._v(" 修改为 "),e("code",[s._v('DEFROUTE="static"')]),s._v(";")]),s._v(" "),e("li",[s._v("添加固定 IP 地址 "),e("code",[s._v('IPADDR="192.168.1.**"')]),s._v(" (假设在 192.168.1.0/24 网段下);")]),s._v(" "),e("li",[s._v("添加网关 "),e("code",[s._v('GATEWAY="192.168.1.1"')]),s._v(", 网关信息可以参考宿主机的网络配置;")]),s._v(" "),e("li",[s._v("添加 DNS "),e("code",[s._v('DNS1="114.114.114.114"')]),s._v(", 这也可以参考宿主机的网络配置, 这个 DNS 应该是移动联动的 DNS 服务器地址.")])]),s._v(" "),e("p",[s._v("接下来修改 "),e("code",[s._v("/etc/sysconfig/network")]),s._v(",")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NETWORKING")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("随便写, 例如 localhost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 照着上面的网关写")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("修改完毕后, 重启 network 服务, 可以使用 "),e("code",[s._v("ip addr")]),s._v(" 与 "),e("code",[s._v("ping")]),s._v(" 命令检查网络情况.")])])}),[],!1,null,null,null);t.default=n.exports}}]);