<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>反射 | SmacUL&#39;s Blog</title>
    <meta name="description" content="你好">
    <link rel="icon" href="/assets/img/Logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.e8ff0ee6.css" as="style"><link rel="preload" href="/assets/js/app.27d58fa7.js" as="script"><link rel="preload" href="/assets/js/2.f1f09924.js" as="script"><link rel="preload" href="/assets/js/15.7ddd6566.js" as="script"><link rel="prefetch" href="/assets/js/10.da04177b.js"><link rel="prefetch" href="/assets/js/11.33537db2.js"><link rel="prefetch" href="/assets/js/12.2c196981.js"><link rel="prefetch" href="/assets/js/13.501a5542.js"><link rel="prefetch" href="/assets/js/14.93a9b12d.js"><link rel="prefetch" href="/assets/js/16.32ee58e2.js"><link rel="prefetch" href="/assets/js/17.c415498a.js"><link rel="prefetch" href="/assets/js/18.5ef64d19.js"><link rel="prefetch" href="/assets/js/19.521006c9.js"><link rel="prefetch" href="/assets/js/20.1aa33ed7.js"><link rel="prefetch" href="/assets/js/21.82b9d691.js"><link rel="prefetch" href="/assets/js/22.793f9d85.js"><link rel="prefetch" href="/assets/js/23.0ca70d66.js"><link rel="prefetch" href="/assets/js/24.d86f1591.js"><link rel="prefetch" href="/assets/js/25.2ce3a84b.js"><link rel="prefetch" href="/assets/js/26.12cdc3ac.js"><link rel="prefetch" href="/assets/js/27.7b341d36.js"><link rel="prefetch" href="/assets/js/28.61c57439.js"><link rel="prefetch" href="/assets/js/29.90d6873f.js"><link rel="prefetch" href="/assets/js/3.7db0d588.js"><link rel="prefetch" href="/assets/js/30.4f5e13f5.js"><link rel="prefetch" href="/assets/js/31.7ec86adf.js"><link rel="prefetch" href="/assets/js/32.0c179479.js"><link rel="prefetch" href="/assets/js/33.b68ce17c.js"><link rel="prefetch" href="/assets/js/34.6d314a9c.js"><link rel="prefetch" href="/assets/js/35.15ecee78.js"><link rel="prefetch" href="/assets/js/36.d6998519.js"><link rel="prefetch" href="/assets/js/37.e84aeb89.js"><link rel="prefetch" href="/assets/js/38.8bd5bba9.js"><link rel="prefetch" href="/assets/js/39.ffd3bce6.js"><link rel="prefetch" href="/assets/js/4.9b31f553.js"><link rel="prefetch" href="/assets/js/40.1b57eaa8.js"><link rel="prefetch" href="/assets/js/41.ac6f9062.js"><link rel="prefetch" href="/assets/js/42.8854bf5a.js"><link rel="prefetch" href="/assets/js/43.91bf82a7.js"><link rel="prefetch" href="/assets/js/44.c35012af.js"><link rel="prefetch" href="/assets/js/45.07b8e581.js"><link rel="prefetch" href="/assets/js/46.02916103.js"><link rel="prefetch" href="/assets/js/47.f1be0d43.js"><link rel="prefetch" href="/assets/js/48.7f7c7f55.js"><link rel="prefetch" href="/assets/js/49.6692487b.js"><link rel="prefetch" href="/assets/js/5.23b29502.js"><link rel="prefetch" href="/assets/js/50.6c2f6d29.js"><link rel="prefetch" href="/assets/js/51.f7be7c31.js"><link rel="prefetch" href="/assets/js/52.b9dad83f.js"><link rel="prefetch" href="/assets/js/53.8f778f89.js"><link rel="prefetch" href="/assets/js/54.9853cbd5.js"><link rel="prefetch" href="/assets/js/55.f1dfad52.js"><link rel="prefetch" href="/assets/js/56.a89162ce.js"><link rel="prefetch" href="/assets/js/57.b1f1111f.js"><link rel="prefetch" href="/assets/js/58.08f753ab.js"><link rel="prefetch" href="/assets/js/59.e2ff4e09.js"><link rel="prefetch" href="/assets/js/6.ca86ed4c.js"><link rel="prefetch" href="/assets/js/60.14c1ce69.js"><link rel="prefetch" href="/assets/js/61.06a9c523.js"><link rel="prefetch" href="/assets/js/62.af6d0bf2.js"><link rel="prefetch" href="/assets/js/63.47139735.js"><link rel="prefetch" href="/assets/js/64.1b3689b6.js"><link rel="prefetch" href="/assets/js/65.c599d8e8.js"><link rel="prefetch" href="/assets/js/66.91648506.js"><link rel="prefetch" href="/assets/js/67.ecf7742c.js"><link rel="prefetch" href="/assets/js/68.b8769d15.js"><link rel="prefetch" href="/assets/js/69.e055ff05.js"><link rel="prefetch" href="/assets/js/7.9d170f74.js"><link rel="prefetch" href="/assets/js/70.065d9e72.js"><link rel="prefetch" href="/assets/js/71.840612b5.js"><link rel="prefetch" href="/assets/js/72.2a605e0c.js"><link rel="prefetch" href="/assets/js/73.3e54fae5.js"><link rel="prefetch" href="/assets/js/74.8e626e7b.js"><link rel="prefetch" href="/assets/js/75.c64b57c0.js"><link rel="prefetch" href="/assets/js/76.0e7007be.js"><link rel="prefetch" href="/assets/js/77.c8b770b0.js"><link rel="prefetch" href="/assets/js/78.d7da3c62.js"><link rel="prefetch" href="/assets/js/79.a78c6d63.js"><link rel="prefetch" href="/assets/js/8.3616387d.js"><link rel="prefetch" href="/assets/js/80.dda2cb25.js"><link rel="prefetch" href="/assets/js/81.2f232306.js"><link rel="prefetch" href="/assets/js/82.df6bca63.js"><link rel="prefetch" href="/assets/js/83.6251af59.js"><link rel="prefetch" href="/assets/js/84.d3eda27f.js"><link rel="prefetch" href="/assets/js/85.71180abd.js"><link rel="prefetch" href="/assets/js/86.3c5a5f86.js"><link rel="prefetch" href="/assets/js/87.12474af5.js"><link rel="prefetch" href="/assets/js/9.c04fa05e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8ff0ee6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">SmacUL's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/self/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/SmacUL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/self/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/SmacUL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/lang/java/" class="sidebar-link">Java 笔记</a></li><li><a href="/lang/java/数据类型.html" class="sidebar-link">数据管理</a></li><li><a href="/lang/java/反射.html" class="active sidebar-link">反射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lang/java/反射.html#为什么要有反射" class="sidebar-link">为什么要有反射</a></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#反射的基本原理" class="sidebar-link">反射的基本原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lang/java/反射.html#java-代码的处理过程" class="sidebar-link">Java 代码的处理过程</a></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#简单地看一下与反射相关的包与-api" class="sidebar-link">简单地看一下与反射相关的包与 API</a></li></ul></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#反射的作用" class="sidebar-link">反射的作用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lang/java/反射.html#分析类" class="sidebar-link">分析类</a></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#分析对象" class="sidebar-link">分析对象</a></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#调用方法" class="sidebar-link">调用方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/lang/java/反射.html#总结-2" class="sidebar-link">总结</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="反射"><a href="#反射" class="header-anchor">#</a> 反射</h1> <p>反射是 Java 的特有概念, 简单来说就是允许程序在运行过程<strong>获得</strong>甚至<strong>修改</strong>类及类内部的相关信息. 总的来说, 反射允许我们从一个特别的角度了解并操纵类与对象.</p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>反射的部分还缺少泛型的解释与说明, 以及数组的解释与说明</p></div> <h2 id="为什么要有反射"><a href="#为什么要有反射" class="header-anchor">#</a> 为什么要有反射</h2> <p>面向对象编程应该努力做到只操纵基类的引用, 保证大部分代码尽可能少的了解对象的具体类型. 然后我们想想 Java 中的多态, 我们很多时候都不会在代码中明确说明 某个引用具体指引着哪个类的对象, 更多的只会写下基类的引用.</p> <p>那么问题来了, JVM 在执行类加载的时候, 如何知道某一个引用具体指向的是哪个类的对象? 又比如, 在泛型程序设计或者框架设计中, 如何创建一个更加通用的程序(使用 if 判断注入的对象通常是不明智的).</p> <h2 id="反射的基本原理"><a href="#反射的基本原理" class="header-anchor">#</a> 反射的基本原理</h2> <h3 id="java-代码的处理过程"><a href="#java-代码的处理过程" class="header-anchor">#</a> Java 代码的处理过程</h3> <blockquote><p>在程序运行期间, Java 运行时系统始终为所有的对象维护一个被称为运行时的类型标识. 这个信息跟踪着每个对象所属的类. JVM 利用运行时类型信息选择相应的方法执行.</p></blockquote> <p>捋一捋上面这句话, 先只考虑最简单的情况, 一个类包括类构造器与类属性和类方法, 类构造器和类方法又包括方法签名和逻辑代码.</p> <h4 id="编写代码"><a href="#编写代码" class="header-anchor">#</a> 编写代码</h4> <p>在使用的时候, 我们先从静态方法 <code>main()</code> 开始, 想办法创建对象, 以及这些对象对应的引用, 然后调用方法或者属性编写逻辑. 我们编写好的程序会被存放到硬盘(或者别的什么地方)上等待 JVM 的加载.</p> <h4 id="编译"><a href="#编译" class="header-anchor">#</a> 编译</h4> <p>如果我们下达了执行命令, JVM 就会编译 <code>.java</code> 文件将其转为 <code>.class</code> 文件. 这个过程中, 代码内每一个我们创建的类都会拥有一个与自己同名的 <code>.class</code> 文件用来记录类的内部信息.</p> <h4 id="加载"><a href="#加载" class="header-anchor">#</a> 加载</h4> <p>这些文件被 JVM 加载后就会成为 <code>Class</code> 对象(属于 <code>Class</code> 类), 这些对象将包含类属性集合对象(<code>Field[]</code> 对象), 类构造器集合对象(<code>Constructor[]</code> 对象), 类方法集合对象(<code>Method[]</code> 对象).</p> <img src="/note/img/2019-12-09-16-34-53.png" style="zoom:30%;display:block;margin:0 auto;"> <h4 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h4> <p>从上面可以看出, 一切的一切都指向了 <code>java.lang.Class</code> 类. 此外还有 <code>java.lang.reflect.Field</code>, <code>java.lang.reflect.Method</code>, <code>java.lang.reflect.Constructor</code>;</p> <h3 id="简单地看一下与反射相关的包与-api"><a href="#简单地看一下与反射相关的包与-api" class="header-anchor">#</a> 简单地看一下与反射相关的包与 API</h3> <h4 id="object-类"><a href="#object-类" class="header-anchor">#</a> Object 类</h4> <ul><li><code>public final native Class&lt;?&gt; getClass()</code><br>
Java 中所有的类都会继承 Object 类, 而 Object 类存在方法 <code>getName()</code>, 那么可以使用此方法获得当前对象对应的 Class 对象的引用.</li></ul> <h4 id="class-类"><a href="#class-类" class="header-anchor">#</a> Class 类</h4> <ul><li><code>public String getName()</code><br>
获得当前 Class 对象的名称.</li> <li><code>public static Class&lt;?&gt; forName(String className)</code><br>
通过 Class 对象的名称(加上包名)获得相应的 Class 对象的引用.</li> <li><code>public T newInstance()</code><br>
这个方法会可以返回一个当前 Class 对象对应的 T 类对象的引用. 但是 T 类中应该包含一个默认构造器, 否则将报错.</li> <li><code>public Field[] getFields()</code> / <code>public Field[] getDeclareFields()</code><br>
返回一个类对象中所有公有的/全部的 Field 对象的引用</li> <li><code>public Method[] getMethods()</code> / <code>public Method[] getDeclareMethods()</code><br>
返回一个类对象中所有公有的/全部的 Method 对象的引用</li> <li><code>public Constructor&lt;?&gt;[] getConstructors()</code> / <code>public Constructor&lt;?&gt;[] getDeclareConstructors()</code><br>
返回一个类对象中所有公有的/全部的 Constructor 对象的引用</li></ul> <h4 id="大部分的方法用起来都差不多-下面给出一个示例"><a href="#大部分的方法用起来都差不多-下面给出一个示例" class="header-anchor">#</a> 大部分的方法用起来都差不多, 下面给出一个示例:</h4> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> lang<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello this is func&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> 
        <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">InstantiationException</span> 
    <span class="token punctuation">{</span>
        <span class="token comment">// 获取 Test 类对应的 Class 对象的引用 testClass</span>
        <span class="token class-name">Class</span> testClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;lang.Test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建 Test 类对象</span>
        <span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Test</span><span class="token punctuation">)</span>testClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        test<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="反射的作用"><a href="#反射的作用" class="header-anchor">#</a> 反射的作用</h2> <p>底下是一些常见的反射功能.</p> <h3 id="分析类"><a href="#分析类" class="header-anchor">#</a> 分析类</h3> <p>前面提到过 <code>java.lang.reflect.Field</code>, <code>java.lang.reflect.Method</code>, <code>java.lang.reflect.Constructor</code> 这三个类分别对应了类的域, 方法和构造方法. 三个类的使用和 Class 类也非常类似. 还可以获得类成员的访问限制情况. 但是, 这三个类没有直接获取基类成员的能力.</p> <h3 id="分析对象"><a href="#分析对象" class="header-anchor">#</a> 分析对象</h3> <p>在运行时, JVM 会以类为模板创造对象, 每个对象都有自己的状态, 那么这一节就专门讨论如何获得与修改对象状态, 同时, 进行这类操作还会受到 Java 的权限控制的影响.</p> <p>下面的代码中, 我们会干这么几件事:</p> <ol><li>创建一个 Test 类对象.</li> <li>获得这个 <code>Test 类</code> 对应的 <code>Class 类对象</code> (可能会有点绕) , 有了 <code>Class 类对象</code>, 由此打开了新世界的大门.</li> <li>获取 <code>Test 类中的成员属性</code> 对应的 <code>Field 类对象</code>.</li> <li>修改访问限制.</li> <li>获取成员属性并打印.</li> <li>修改成员属性并打印.</li></ol> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span>
            <span class="token class-name">NoSuchFieldException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span> testClass <span class="token operator">=</span> test<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Field</span> field <span class="token operator">=</span> testClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> field<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
        test<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        test<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>上面的代码中提到了三个方法:</p> <ul><li>AccessibleObject 类下的 <code>public void setAccessible(boolean flag)</code><br>
跨过访问限制</li> <li>Field 类下的 <code>public Object get(Object obj)</code><br>
获取成员属性的状态</li> <li>Field 类下的 <code>public void set(Object obj, Object value)</code><br>
修改成员属性的状态</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>get 和 set 方法中输入的 Object 对象是需要获取/修改属性的对象, 这里是 Test 对象; 而返回值的 Object 就是属性的值, 如果是基本类型, 反射会自动处理. 这种写法看着可能有些奇怪, 因为每个类都可能有多个对象, 也就存在多组属性状态, 必须告知 get/set 需要处理的是具体哪个对象下的属性.</p></div> <h3 id="调用方法"><a href="#调用方法" class="header-anchor">#</a> 调用方法</h3> <p>还是之前那个例子:</p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span>
            <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchMethodException</span><span class="token punctuation">,</span> <span class="token class-name">InvocationTargetException</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span> testClass <span class="token operator">=</span> test<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Method</span> method <span class="token operator">=</span> testClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">&quot;func&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>这里出现了一个不太一样的方法: <code>public Object invoke(Object obj, Object... args)</code> , 它对应之前看到的 set 和 get 方法. 他同样需要具体的对象引用 test 作为参数, 如果调用的方法需要参数化, 那么还需要给出具体的参数.</p> <h2 id="总结-2"><a href="#总结-2" class="header-anchor">#</a> 总结</h2> <p>在最初学习 Java 的时候, 我认为反射是一个建设框架才需要学习的知识, 后来接触到了一些后端框架, 才慢慢意识到了解反射的重要性.</p> <p>总的来说, 反射是允许我们在 JVM 层面以上 &quot;为所欲为&quot; 的基础. 但是 &quot;劲酒不能贪杯&quot; , 当有其他备选的而且几乎等效的手段, 就应该避免使用反射. 不正确的反射会带来一些难以察觉的错误.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/23/2019, 7:43:35 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/lang/java/数据类型.html" class="prev">数据管理</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.27d58fa7.js" defer></script><script src="/assets/js/2.f1f09924.js" defer></script><script src="/assets/js/15.7ddd6566.js" defer></script>
  </body>
</html>
